{"ast":null,"code":"// Helper: turn minutes into span [start, end] on a fixed reference night (23:00 -> 07:00)\nfunction buildSpansFromMinutes(stageMinutes, startHour = 23) {\n  let cursor = startHour;\n  return Object.entries(stageMinutes).map(([stage, minutes]) => {\n    const hours = minutes / 60;\n    const span = [cursor, cursor + hours];\n    cursor += hours;\n    return {\n      stage,\n      spans: [span]\n    };\n  });\n}\nexport default function calcSleepAverages(sleepArray) {\n  console.log(\"calcSleepAverages called with sleepArray.length:\", sleepArray.length);\n  if (sleepArray.length === 0) {\n    console.log(\"calcSleepAverages: No sleep data, returning null\");\n    return null;\n  }\n  console.log(\"calcSleepAverages: sleepArray[0]:\", sleepArray[0]);\n\n  // Sum minutes\n  const totals = sleepArray.reduce((acc, night) => {\n    if (night.sleep) {\n      var _night$sleep$deep, _night$sleep$light, _night$sleep$rem, _night$sleep$wake;\n      acc.deep += ((_night$sleep$deep = night.sleep.deep) === null || _night$sleep$deep === void 0 ? void 0 : _night$sleep$deep.minutes) || 0;\n      acc.light += ((_night$sleep$light = night.sleep.light) === null || _night$sleep$light === void 0 ? void 0 : _night$sleep$light.minutes) || 0;\n      acc.rem += ((_night$sleep$rem = night.sleep.rem) === null || _night$sleep$rem === void 0 ? void 0 : _night$sleep$rem.minutes) || 0;\n      acc.wake += ((_night$sleep$wake = night.sleep.wake) === null || _night$sleep$wake === void 0 ? void 0 : _night$sleep$wake.minutes) || 0;\n    }\n    return acc;\n  }, {\n    deep: 0,\n    light: 0,\n    rem: 0,\n    wake: 0\n  });\n  const count = sleepArray.length;\n  const averages = {\n    deep: Math.round(totals.deep / count),\n    light: Math.round(totals.light / count),\n    rem: Math.round(totals.rem / count)\n    // skip wake because we don’t show it in SpanChart\n  };\n  return averages;\n}","map":{"version":3,"names":["buildSpansFromMinutes","stageMinutes","startHour","cursor","Object","entries","map","stage","minutes","hours","span","spans","calcSleepAverages","sleepArray","console","log","length","totals","reduce","acc","night","sleep","_night$sleep$deep","_night$sleep$light","_night$sleep$rem","_night$sleep$wake","deep","light","rem","wake","count","averages","Math","round"],"sources":["C:/Users/jenni.mikkonen/OneDrive - LightningChart Ltd/Repos/lcjs-dashboard/frontend/src/utils/calcSleepAverages.js"],"sourcesContent":["// Helper: turn minutes into span [start, end] on a fixed reference night (23:00 -> 07:00)\r\nfunction buildSpansFromMinutes(stageMinutes, startHour = 23) {\r\n  let cursor = startHour\r\n  return Object.entries(stageMinutes).map(([stage, minutes]) => {\r\n    const hours = minutes / 60\r\n    const span = [cursor, cursor + hours]\r\n    cursor += hours\r\n    return { stage, spans: [span] }\r\n  })\r\n}\r\n\r\nexport default function calcSleepAverages(sleepArray) {\r\n  console.log(\"calcSleepAverages called with sleepArray.length:\", sleepArray.length);\r\n  if (sleepArray.length === 0) {\r\n    console.log(\"calcSleepAverages: No sleep data, returning null\");\r\n    return null;\r\n  }\r\n\r\n  console.log(\"calcSleepAverages: sleepArray[0]:\", sleepArray[0]);\r\n\r\n  // Sum minutes\r\n  const totals = sleepArray.reduce(\r\n    (acc, night) => {\r\n      if (night.sleep) {\r\n        acc.deep += night.sleep.deep?.minutes || 0\r\n        acc.light += night.sleep.light?.minutes || 0\r\n        acc.rem += night.sleep.rem?.minutes || 0\r\n        acc.wake += night.sleep.wake?.minutes || 0\r\n      }\r\n      return acc\r\n    },\r\n    { deep: 0, light: 0, rem: 0, wake: 0 }\r\n  )\r\n\r\n  const count = sleepArray.length\r\n  const averages = {\r\n    deep: Math.round(totals.deep / count),\r\n    light: Math.round(totals.light / count),\r\n    rem: Math.round(totals.rem / count),\r\n    // skip wake because we don’t show it in SpanChart\r\n  }\r\n\r\n  return averages\r\n}\r\n"],"mappings":"AAAA;AACA,SAASA,qBAAqBA,CAACC,YAAY,EAAEC,SAAS,GAAG,EAAE,EAAE;EAC3D,IAAIC,MAAM,GAAGD,SAAS;EACtB,OAAOE,MAAM,CAACC,OAAO,CAACJ,YAAY,CAAC,CAACK,GAAG,CAAC,CAAC,CAACC,KAAK,EAAEC,OAAO,CAAC,KAAK;IAC5D,MAAMC,KAAK,GAAGD,OAAO,GAAG,EAAE;IAC1B,MAAME,IAAI,GAAG,CAACP,MAAM,EAAEA,MAAM,GAAGM,KAAK,CAAC;IACrCN,MAAM,IAAIM,KAAK;IACf,OAAO;MAAEF,KAAK;MAAEI,KAAK,EAAE,CAACD,IAAI;IAAE,CAAC;EACjC,CAAC,CAAC;AACJ;AAEA,eAAe,SAASE,iBAAiBA,CAACC,UAAU,EAAE;EACpDC,OAAO,CAACC,GAAG,CAAC,kDAAkD,EAAEF,UAAU,CAACG,MAAM,CAAC;EAClF,IAAIH,UAAU,CAACG,MAAM,KAAK,CAAC,EAAE;IAC3BF,OAAO,CAACC,GAAG,CAAC,kDAAkD,CAAC;IAC/D,OAAO,IAAI;EACb;EAEAD,OAAO,CAACC,GAAG,CAAC,mCAAmC,EAAEF,UAAU,CAAC,CAAC,CAAC,CAAC;;EAE/D;EACA,MAAMI,MAAM,GAAGJ,UAAU,CAACK,MAAM,CAC9B,CAACC,GAAG,EAAEC,KAAK,KAAK;IACd,IAAIA,KAAK,CAACC,KAAK,EAAE;MAAA,IAAAC,iBAAA,EAAAC,kBAAA,EAAAC,gBAAA,EAAAC,iBAAA;MACfN,GAAG,CAACO,IAAI,IAAI,EAAAJ,iBAAA,GAAAF,KAAK,CAACC,KAAK,CAACK,IAAI,cAAAJ,iBAAA,uBAAhBA,iBAAA,CAAkBd,OAAO,KAAI,CAAC;MAC1CW,GAAG,CAACQ,KAAK,IAAI,EAAAJ,kBAAA,GAAAH,KAAK,CAACC,KAAK,CAACM,KAAK,cAAAJ,kBAAA,uBAAjBA,kBAAA,CAAmBf,OAAO,KAAI,CAAC;MAC5CW,GAAG,CAACS,GAAG,IAAI,EAAAJ,gBAAA,GAAAJ,KAAK,CAACC,KAAK,CAACO,GAAG,cAAAJ,gBAAA,uBAAfA,gBAAA,CAAiBhB,OAAO,KAAI,CAAC;MACxCW,GAAG,CAACU,IAAI,IAAI,EAAAJ,iBAAA,GAAAL,KAAK,CAACC,KAAK,CAACQ,IAAI,cAAAJ,iBAAA,uBAAhBA,iBAAA,CAAkBjB,OAAO,KAAI,CAAC;IAC5C;IACA,OAAOW,GAAG;EACZ,CAAC,EACD;IAAEO,IAAI,EAAE,CAAC;IAAEC,KAAK,EAAE,CAAC;IAAEC,GAAG,EAAE,CAAC;IAAEC,IAAI,EAAE;EAAE,CACvC,CAAC;EAED,MAAMC,KAAK,GAAGjB,UAAU,CAACG,MAAM;EAC/B,MAAMe,QAAQ,GAAG;IACfL,IAAI,EAAEM,IAAI,CAACC,KAAK,CAAChB,MAAM,CAACS,IAAI,GAAGI,KAAK,CAAC;IACrCH,KAAK,EAAEK,IAAI,CAACC,KAAK,CAAChB,MAAM,CAACU,KAAK,GAAGG,KAAK,CAAC;IACvCF,GAAG,EAAEI,IAAI,CAACC,KAAK,CAAChB,MAAM,CAACW,GAAG,GAAGE,KAAK;IAClC;EACF,CAAC;EAED,OAAOC,QAAQ;AACjB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}