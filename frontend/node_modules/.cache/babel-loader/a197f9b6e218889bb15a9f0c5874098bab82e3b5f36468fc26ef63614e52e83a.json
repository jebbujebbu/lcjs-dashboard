{"ast":null,"code":"var _jsxFileName = \"D:\\\\Repos\\\\lcjs-dashboard\\\\frontend\\\\src\\\\pages\\\\Dashboard.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { useEffect, useState, useRef } from 'react';\nimport '../styles/Dashboard.css';\nimport MultiChart from '../components/MultiChart.jsx';\nimport GaugeChart from '../components/charts/GaugeChart.jsx';\nimport BarChart from '../components/charts/BarChart.jsx';\nimport PieChart from '../components/charts/PieChart.jsx';\nimport SpanChart from '../components/charts/SpanChart.jsx';\nimport SpiderChart from '../components/charts/SpiderChart.jsx';\nimport MosaicChart from '../components/charts/MosaicChart.jsx';\nimport convertTemperatures from '../utils/convertTemperatures.js';\nimport calcActivityScore from '../utils/calcActivityScore.js';\nimport getLast7Days from '../utils/getLast7Days.js';\nimport calcSleepAverages from '../utils/calcSleepAverages.js';\nimport calcWellnessIndex from '../utils/calcWellnessIndex.js';\nimport getInitialData from '../utils/getInitialData.js';\nimport toChartSpans from '../utils/toChartSpans.js';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst Dashboard = () => {\n  _s();\n  const [minuteSeries, setMinuteSeries] = useState([]);\n  const [hourSeries, setHourSeries] = useState([]);\n  const [daySeries, setDaySeries] = useState([]);\n  const [sleepSeries, setSleepSeries] = useState([]);\n  const [currentSteps, setCurrentSteps] = useState(0);\n  const [dailySteps, setDailySteps] = useState(0);\n  const [currentStages, setCurrentStages] = useState(null);\n  const [avgStages, setAvgStages] = useState(null);\n  const minuteIndexRef = useRef(0);\n  const hourIndexRef = useRef(0);\n  const [activity, setActivity] = useState(null);\n  const [wellness, setWellness] = useState(null);\n  const [currentDataPoint, setCurrentDataPoint] = useState(null);\n  const [simulationSpeed, setSimulationSpeed] = useState(16); // Default 16ms\n  const [isSimulationRunning, setIsSimulationRunning] = useState(true);\n\n  // Speed conversion helper\n  const getSpeedLabel = speed => {\n    const multiplier = 16 / speed;\n    if (multiplier >= 1) {\n      return `${multiplier.toFixed(1)}x`;\n    } else {\n      return `${(1 / multiplier).toFixed(1)}x slower`;\n    }\n  };\n  const formatTimestamp = timestamp => {\n    if (!timestamp) return '00:00:00';\n    const date = new Date(timestamp);\n    return date.toLocaleTimeString('en-US', {\n      hour12: false,\n      hour: '2-digit',\n      minute: '2-digit',\n      second: '2-digit'\n    });\n  };\n  useEffect(() => {\n    const controller = new AbortController();\n    Promise.all([fetch(\"/api/data\", {\n      signal: controller.signal\n    }).then(r => r.json()), fetch(\"/api/sleep-data\", {\n      signal: controller.signal\n    }).then(r => r.json())]).then(([data, sleepData]) => {\n      if (!data || !sleepData) return;\n\n      // Convert temperature deviation values to absolute temperature values\n      convertTemperatures(data.hourSeries);\n\n      // Update state with the fetched data\n      setMinuteSeries(data.minuteSeries || []);\n      setHourSeries(data.hourSeries || []);\n      setDaySeries(data.daySeries || []);\n      setSleepSeries(sleepData.daySeries || []);\n\n      // Initialize charts with data from the last 7 days of data set (ending 2022-01-21)\n      const initialData = getInitialData(data.minuteSeries, data.hourSeries, data.daySeries, sleepData.daySeries);\n      setCurrentStages(toChartSpans(initialData.currentStages));\n      setAvgStages(initialData.avgStages);\n      setWellness(initialData.wellness);\n    }).catch(err => {\n      if (err.name === \"AbortError\") {\n        console.log(\"Fetch aborted\");\n      } else {\n        console.error(\"Error fetching data:\", err);\n      }\n    });\n    return () => {\n      controller.abort();\n    };\n  }, []);\n  useEffect(() => {\n    if (minuteSeries.length === 0 || hourSeries.length === 0 || daySeries.length === 0 || !isSimulationRunning) {\n      console.log(\"Waiting for data or simulation paused...\");\n      return;\n    }\n    const interval = setInterval(() => {\n      // Update minute data every cycle\n      let nextMinuteIndex = (minuteIndexRef.current + 1) % minuteSeries.length;\n      const currentMinuteData = minuteSeries[nextMinuteIndex];\n      if (!(currentMinuteData !== null && currentMinuteData !== void 0 && currentMinuteData.timestamp)) {\n        minuteIndexRef.current = nextMinuteIndex;\n        return;\n      }\n      const currentTime = currentMinuteData.timestamp;\n      const date = currentTime.split('T')[0];\n      const hour = parseInt(currentTime.slice(11, 13));\n      const minute = parseInt(currentTime.slice(14, 16));\n\n      // Check if hour changed, update hourSeries data\n      if (minute === 0) {\n        let nextHourIndex = (hourIndexRef.current + 1) % hourSeries.length;\n        const currentHourData = hourSeries[nextHourIndex];\n\n        // Merge minute and hour data\n        const combinedData = {\n          ...currentMinuteData,\n          stress: currentHourData === null || currentHourData === void 0 ? void 0 : currentHourData.stress,\n          temperature: currentHourData === null || currentHourData === void 0 ? void 0 : currentHourData.temperature,\n          steps: dailySteps + (currentMinuteData.steps || 0)\n        };\n        setCurrentDataPoint(combinedData);\n        hourIndexRef.current = nextHourIndex;\n      } else {\n        // Just update with minute data + accumulated steps\n        const updatedData = {\n          ...currentMinuteData,\n          steps: dailySteps + (currentMinuteData.steps || 0)\n        };\n        setCurrentDataPoint(updatedData);\n      }\n\n      // Handle 00:00 updates\n      if (hour === 0 && minute === 0) {\n        console.log(\"Midnight 00:00\");\n\n        // Reset daily steps\n        setDailySteps(0);\n\n        // Update MosaicChart with 7-day activity data\n        const last7days = getLast7Days(minuteSeries, currentTime); //currentTime \"2021-05-24T00:00:00Z\"\n\n        // Group by day and hour, calculate hourly totals\n        const dailyHourlyTotals = {};\n        last7days.forEach(record => {\n          const day = record.timestamp.split('T')[0];\n          const hour = parseInt(record.timestamp.slice(11, 13));\n          if (!dailyHourlyTotals[day]) {\n            dailyHourlyTotals[day] = {};\n          }\n          if (!dailyHourlyTotals[day][hour]) {\n            dailyHourlyTotals[day][hour] = {\n              calories: 0,\n              steps: 0\n            };\n          }\n          dailyHourlyTotals[day][hour].calories += record.calories || 0;\n          dailyHourlyTotals[day][hour].steps += record.steps || 0;\n        });\n\n        // Calculate activity percentages for each day\n        const activityArray = Object.entries(dailyHourlyTotals).sort(([dateA], [dateB]) => dateA.localeCompare(dateB)) // Sort by date\n        .map(([date, hourlyTotals]) => {\n          const hourlyScores = {\n            low: 0,\n            medium: 0,\n            high: 0\n          };\n          const totalHours = Object.keys(hourlyTotals).length;\n\n          // Calculate score for each hour\n          Object.values(hourlyTotals).forEach(hourData => {\n            const score = calcActivityScore(hourData.calories, hourData.steps);\n            hourlyScores[score]++;\n          });\n\n          // Convert to percentages\n          const result = {\n            date: date,\n            low: Math.round(hourlyScores.low / totalHours * 100),\n            medium: Math.round(hourlyScores.medium / totalHours * 100),\n            high: Math.round(hourlyScores.high / totalHours * 100),\n            totalHours: totalHours\n          };\n          return result;\n        });\n        setActivity(activityArray);\n      } else {\n        // Accumulate steps throughout the day\n        setDailySteps(prev => prev + (currentMinuteData.steps || 0));\n      }\n\n      // Handle 08:00 updates\n      if (hour === 8 && minute === 0) {\n        console.log(\"Eight AM 08:00\");\n\n        // Find last night's sleep data\n        const lastNight = daySeries.find(day => day.date === date);\n        if (lastNight !== null && lastNight !== void 0 && lastNight.sleep) {\n          const spans = toChartSpans(lastNight.sleep.levels);\n          setCurrentStages(spans);\n\n          // Calculate 7-night average\n          const last7Nights = getLast7Days(sleepSeries, currentTime);\n          console.log(\"8 AM update - last7Nights:\", last7Nights);\n          const avgSleep = calcSleepAverages(last7Nights);\n          console.log(\"8 AM update - avgSleep:\", avgSleep);\n          setAvgStages(avgSleep);\n        } else {\n          console.log(\"No sleep data found for\", date);\n        }\n\n        // Get yesterday's data for wellness calculation\n        const currentDateTime = new Date(currentTime + (currentTime.endsWith('Z') ? '' : 'Z'));\n        const yesterday = new Date(currentDateTime.getTime() - 24 * 60 * 60 * 1000);\n        const yesterdayStr = yesterday.toISOString().split('T')[0];\n\n        // Get yesterday's minute data\n        const yesterdayMinuteData = minuteSeries.filter(record => (record === null || record === void 0 ? void 0 : record.timestamp) && record.timestamp.startsWith(yesterdayStr));\n\n        // Get yesterday's hour data  \n        const yesterdayHourData = hourSeries.filter(record => (record === null || record === void 0 ? void 0 : record.timestamp) && record.timestamp.startsWith(yesterdayStr));\n\n        // Calculate wellness index for yesterday\n        const wellnessIndex = calcWellnessIndex(yesterdayMinuteData, yesterdayHourData, lastNight.sleep);\n        setWellness(wellnessIndex);\n      }\n      setCurrentSteps(currentMinuteData.steps);\n      minuteIndexRef.current = nextMinuteIndex;\n    }, simulationSpeed);\n    return () => clearInterval(interval);\n  }, [minuteSeries, hourSeries, daySeries, sleepSeries, dailySteps, simulationSpeed, isSimulationRunning]);\n  if (minuteSeries.length === 0) {\n    console.log(\"Loading data, minuteSeries.length:\", minuteSeries.length);\n    return /*#__PURE__*/_jsxDEV(\"p\", {\n      children: \"Loading data\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"speed-control-panel\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"speed-controls\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"timestamp-display\",\n          children: formatTimestamp(currentDataPoint === null || currentDataPoint === void 0 ? void 0 : currentDataPoint.timestamp)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 266,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"speed-section\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            htmlFor: \"speed-slider\",\n            children: [\"Speed: \", simulationSpeed, \"ms\"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 271,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"speed-slider\",\n            type: \"range\",\n            min: \"1\",\n            max: \"100\",\n            step: \"1\",\n            value: simulationSpeed,\n            onChange: e => setSimulationSpeed(parseInt(e.target.value, 10)),\n            className: \"speed-slider\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 272,\n            columnNumber: 11\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => setIsSimulationRunning(!isSimulationRunning),\n            className: \"pause-button\",\n            children: isSimulationRunning ? 'Pause' : 'Resume'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 282,\n            columnNumber: 11\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 270,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 7\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 5\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"dashboard-grid\",\n      children: [currentDataPoint && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"multi\",\n          children: /*#__PURE__*/_jsxDEV(MultiChart, {\n            data: currentDataPoint,\n            steps: currentSteps,\n            titles: [\"Heart Rate\", \"Steps/Min\", \"Kcal/Min\"]\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 296,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 295,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"stress\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gauge\",\n            children: /*#__PURE__*/_jsxDEV(GaugeChart, {\n              data: {\n                data: currentDataPoint === null || currentDataPoint === void 0 ? void 0 : currentDataPoint.stress\n              },\n              title: \"Stress Level\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 300,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 299,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"steps\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"bar\",\n            children: /*#__PURE__*/_jsxDEV(BarChart, {\n              data: {\n                data: dailySteps\n              },\n              title: \"Daily Steps\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 305,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"status\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"gauge\",\n            children: /*#__PURE__*/_jsxDEV(GaugeChart, {\n              data: {\n                data: currentDataPoint === null || currentDataPoint === void 0 ? void 0 : currentDataPoint.temperature\n              },\n              title: \"Body Temperature\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 310,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 309,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 308,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true), avgStages && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card\",\n        id: \"avgstages\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"pie\",\n          children: /*#__PURE__*/_jsxDEV(PieChart, {\n            data: avgStages,\n            title: \"Sleep Quality Average\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 318,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 317,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 316,\n        columnNumber: 9\n      }, this), currentDataPoint && /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"laststages\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"span\",\n            children: /*#__PURE__*/_jsxDEV(SpanChart, {\n              data: currentStages\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 326,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 324,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"index\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spider\",\n            children: /*#__PURE__*/_jsxDEV(SpiderChart, {\n              data: wellness\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 331,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 330,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 329,\n          columnNumber: 9\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"card\",\n          id: \"activity\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"mosaic\",\n            children: /*#__PURE__*/_jsxDEV(MosaicChart, {\n              data: activity\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 336,\n              columnNumber: 13\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 335,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 9\n        }, this)]\n      }, void 0, true)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 292,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 262,\n    columnNumber: 5\n  }, this);\n};\n_s(Dashboard, \"axwslT2wavqyZzlAAV2gS9TXab8=\");\n_c = Dashboard;\nexport default Dashboard;\nvar _c;\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"names":["React","useEffect","useState","useRef","MultiChart","GaugeChart","BarChart","PieChart","SpanChart","SpiderChart","MosaicChart","convertTemperatures","calcActivityScore","getLast7Days","calcSleepAverages","calcWellnessIndex","getInitialData","toChartSpans","jsxDEV","_jsxDEV","Fragment","_Fragment","Dashboard","_s","minuteSeries","setMinuteSeries","hourSeries","setHourSeries","daySeries","setDaySeries","sleepSeries","setSleepSeries","currentSteps","setCurrentSteps","dailySteps","setDailySteps","currentStages","setCurrentStages","avgStages","setAvgStages","minuteIndexRef","hourIndexRef","activity","setActivity","wellness","setWellness","currentDataPoint","setCurrentDataPoint","simulationSpeed","setSimulationSpeed","isSimulationRunning","setIsSimulationRunning","getSpeedLabel","speed","multiplier","toFixed","formatTimestamp","timestamp","date","Date","toLocaleTimeString","hour12","hour","minute","second","controller","AbortController","Promise","all","fetch","signal","then","r","json","data","sleepData","initialData","catch","err","name","console","log","error","abort","length","interval","setInterval","nextMinuteIndex","current","currentMinuteData","currentTime","split","parseInt","slice","nextHourIndex","currentHourData","combinedData","stress","temperature","steps","updatedData","last7days","dailyHourlyTotals","forEach","record","day","calories","activityArray","Object","entries","sort","dateA","dateB","localeCompare","map","hourlyTotals","hourlyScores","low","medium","high","totalHours","keys","values","hourData","score","result","Math","round","prev","lastNight","find","sleep","spans","levels","last7Nights","avgSleep","currentDateTime","endsWith","yesterday","getTime","yesterdayStr","toISOString","yesterdayMinuteData","filter","startsWith","yesterdayHourData","wellnessIndex","clearInterval","children","fileName","_jsxFileName","lineNumber","columnNumber","className","htmlFor","id","type","min","max","step","value","onChange","e","target","onClick","titles","title","_c","$RefreshReg$"],"sources":["D:/Repos/lcjs-dashboard/frontend/src/pages/Dashboard.jsx"],"sourcesContent":["import React from 'react';\r\nimport { useEffect, useState, useRef } from 'react';\r\nimport '../styles/Dashboard.css';\r\nimport MultiChart from '../components/MultiChart.jsx';\r\nimport GaugeChart from '../components/charts/GaugeChart.jsx';\r\nimport BarChart from '../components/charts/BarChart.jsx'; \r\nimport PieChart from '../components/charts/PieChart.jsx'; \r\nimport SpanChart from '../components/charts/SpanChart.jsx'; \r\nimport SpiderChart from '../components/charts/SpiderChart.jsx'; \r\nimport MosaicChart from '../components/charts/MosaicChart.jsx'; \r\nimport convertTemperatures from '../utils/convertTemperatures.js';\r\nimport calcActivityScore from '../utils/calcActivityScore.js';\r\nimport getLast7Days from '../utils/getLast7Days.js';\r\nimport calcSleepAverages from '../utils/calcSleepAverages.js';\r\nimport calcWellnessIndex from '../utils/calcWellnessIndex.js';\r\nimport getInitialData from '../utils/getInitialData.js';\r\nimport toChartSpans from '../utils/toChartSpans.js';\r\n\r\nconst Dashboard = () => {\r\n  const [minuteSeries, setMinuteSeries] = useState([]);\r\n  const [hourSeries, setHourSeries] = useState([]);\r\n  const [daySeries, setDaySeries] = useState([]);\r\n  const [sleepSeries, setSleepSeries] = useState([]);\r\n  const [currentSteps, setCurrentSteps] = useState(0);\r\n  const [dailySteps, setDailySteps] = useState(0);\r\n  const [currentStages, setCurrentStages] = useState(null);\r\n  const [avgStages, setAvgStages] = useState(null);\r\n  const minuteIndexRef = useRef(0);\r\n  const hourIndexRef = useRef(0);\r\n  const [activity, setActivity] = useState(null);\r\n  const [wellness, setWellness] = useState(null);\r\n  const [currentDataPoint, setCurrentDataPoint] = useState(null);\r\n  const [simulationSpeed, setSimulationSpeed] = useState(16); // Default 16ms\r\n  const [isSimulationRunning, setIsSimulationRunning] = useState(true);\r\n\r\n\r\n  // Speed conversion helper\r\n  const getSpeedLabel = (speed) => {\r\n    const multiplier = 16 / speed;\r\n    if (multiplier >= 1) {\r\n      return `${multiplier.toFixed(1)}x`;\r\n    } else {\r\n      return `${(1/multiplier).toFixed(1)}x slower`;\r\n    }\r\n  };\r\n\r\n  const formatTimestamp = (timestamp) => {\r\n  if (!timestamp) return '00:00:00';\r\n  const date = new Date(timestamp);\r\n  return date.toLocaleTimeString('en-US', { \r\n    hour12: false,\r\n    hour: '2-digit',\r\n    minute: '2-digit',\r\n    second: '2-digit'\r\n  });\r\n};\r\n\r\n  useEffect(() => { \r\n    const controller = new AbortController();\r\n\r\n    Promise.all([\r\n      fetch(\"/api/data\", { signal: controller.signal }).then(r => r.json()),\r\n      fetch(\"/api/sleep-data\", { signal: controller.signal }).then((r) => r.json())\r\n    ])\r\n    .then(([data, sleepData]) => {\r\n      if (!data || !sleepData) return;\r\n\r\n      // Convert temperature deviation values to absolute temperature values\r\n      convertTemperatures(data.hourSeries);\r\n    \r\n      // Update state with the fetched data\r\n      setMinuteSeries(data.minuteSeries || []);\r\n      setHourSeries(data.hourSeries || []);\r\n      setDaySeries(data.daySeries || []);\r\n      setSleepSeries(sleepData.daySeries || []);\r\n      \r\n      // Initialize charts with data from the last 7 days of data set (ending 2022-01-21)\r\n      const initialData = getInitialData(data.minuteSeries, data.hourSeries, data.daySeries, sleepData.daySeries);\r\n      setCurrentStages(toChartSpans(initialData.currentStages));\r\n      setAvgStages(initialData.avgStages);\r\n      setWellness(initialData.wellness);\r\n    })\r\n    .catch((err) => {\r\n      if (err.name === \"AbortError\") {\r\n        console.log(\"Fetch aborted\");\r\n      } else {\r\n        console.error(\"Error fetching data:\", err);\r\n      }\r\n    });\r\n\r\n    return () => {\r\n      controller.abort();\r\n    };\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (minuteSeries.length === 0 || hourSeries.length === 0 || daySeries.length === 0 || !isSimulationRunning) {\r\n      console.log(\"Waiting for data or simulation paused...\");\r\n      return;\r\n    }\r\n\r\n    const interval = setInterval(() => {\r\n      // Update minute data every cycle\r\n      let nextMinuteIndex = (minuteIndexRef.current + 1) % minuteSeries.length;\r\n      const currentMinuteData = minuteSeries[nextMinuteIndex];\r\n\r\n      if (!currentMinuteData?.timestamp) {\r\n        minuteIndexRef.current = nextMinuteIndex;\r\n        return;\r\n      }\r\n\r\n      const currentTime = currentMinuteData.timestamp;\r\n      const date = currentTime.split('T')[0];\r\n      const hour =  parseInt(currentTime.slice(11, 13));\r\n      const minute = parseInt(currentTime.slice(14, 16));\r\n\r\n      // Check if hour changed, update hourSeries data\r\n      if (minute === 0)  {\r\n        let nextHourIndex = (hourIndexRef.current + 1) % hourSeries.length;\r\n        const currentHourData = hourSeries[nextHourIndex];\r\n\r\n        // Merge minute and hour data\r\n        const combinedData = {\r\n          ...currentMinuteData,\r\n          stress: currentHourData?.stress,\r\n          temperature: currentHourData?.temperature,\r\n          steps: dailySteps + (currentMinuteData.steps || 0)            \r\n        };\r\n\r\n        setCurrentDataPoint(combinedData);\r\n\r\n        hourIndexRef.current = nextHourIndex;\r\n      } else {\r\n        // Just update with minute data + accumulated steps\r\n        const updatedData = {\r\n          ...currentMinuteData,\r\n          steps: dailySteps + (currentMinuteData.steps || 0)  \r\n        }\r\n        setCurrentDataPoint(updatedData);\r\n      }\r\n\r\n      // Handle 00:00 updates\r\n      if (hour === 0 && minute === 0)  {\r\n        console.log(\"Midnight 00:00\");\r\n\r\n        // Reset daily steps\r\n        setDailySteps(0);\r\n\r\n        // Update MosaicChart with 7-day activity data\r\n        const last7days = getLast7Days(minuteSeries, currentTime);  //currentTime \"2021-05-24T00:00:00Z\"\r\n        \r\n        // Group by day and hour, calculate hourly totals\r\n        const dailyHourlyTotals = {};\r\n        last7days.forEach(record => {\r\n          const day = record.timestamp.split('T')[0];  \r\n          const hour = parseInt(record.timestamp.slice(11, 13)); \r\n          \r\n          if (!dailyHourlyTotals[day]) {\r\n            dailyHourlyTotals[day] = {};\r\n          }\r\n          if (!dailyHourlyTotals[day][hour]) {\r\n            dailyHourlyTotals[day][hour] = { calories: 0, steps: 0 };\r\n          }\r\n          \r\n          dailyHourlyTotals[day][hour].calories += record.calories || 0;\r\n          dailyHourlyTotals[day][hour].steps += record.steps || 0;\r\n        });\r\n\r\n        // Calculate activity percentages for each day\r\n        const activityArray = Object.entries(dailyHourlyTotals)\r\n          .sort(([dateA], [dateB]) => dateA.localeCompare(dateB)) // Sort by date\r\n          .map(([date, hourlyTotals]) => {\r\n            const hourlyScores = { low: 0, medium: 0, high: 0 };\r\n            const totalHours = Object.keys(hourlyTotals).length;\r\n            \r\n            // Calculate score for each hour\r\n            Object.values(hourlyTotals).forEach(hourData => {\r\n              const score = calcActivityScore(hourData.calories, hourData.steps);\r\n              hourlyScores[score]++;\r\n            });\r\n            \r\n            // Convert to percentages\r\n            const result = {\r\n              date: date,\r\n              low: Math.round((hourlyScores.low / totalHours) * 100),\r\n              medium: Math.round((hourlyScores.medium / totalHours) * 100),\r\n              high: Math.round((hourlyScores.high / totalHours) * 100),\r\n              totalHours: totalHours\r\n            };\r\n            return result;\r\n          });\r\n\r\n        setActivity(activityArray);\r\n      } else {\r\n        // Accumulate steps throughout the day\r\n        setDailySteps(prev => prev + (currentMinuteData.steps || 0));\r\n      }\r\n\r\n      // Handle 08:00 updates\r\n      if (hour === 8 && minute === 0) {\r\n        console.log(\"Eight AM 08:00\");\r\n\r\n        // Find last night's sleep data\r\n        const lastNight = daySeries.find(day => day.date === date);\r\n\r\n        if (lastNight?.sleep) {\r\n          const spans = toChartSpans(lastNight.sleep.levels);\r\n          setCurrentStages(spans);\r\n\r\n          // Calculate 7-night average\r\n          const last7Nights = getLast7Days(sleepSeries, currentTime);\r\n          console.log(\"8 AM update - last7Nights:\", last7Nights);\r\n\r\n          const avgSleep = calcSleepAverages(last7Nights);\r\n          console.log(\"8 AM update - avgSleep:\", avgSleep);\r\n\r\n          setAvgStages(avgSleep);\r\n\r\n        } else {\r\n          console.log(\"No sleep data found for\", date);\r\n        }\r\n\r\n        // Get yesterday's data for wellness calculation\r\n        const currentDateTime = new Date(currentTime + (currentTime.endsWith('Z') ? '' : 'Z'));\r\n        const yesterday = new Date(currentDateTime.getTime() - (24 * 60 * 60 * 1000));\r\n        const yesterdayStr = yesterday.toISOString().split('T')[0];\r\n\r\n        // Get yesterday's minute data\r\n        const yesterdayMinuteData = minuteSeries.filter(record => \r\n          record?.timestamp && record.timestamp.startsWith(yesterdayStr)\r\n        );\r\n\r\n        // Get yesterday's hour data  \r\n        const yesterdayHourData = hourSeries.filter(record =>\r\n          record?.timestamp && record.timestamp.startsWith(yesterdayStr)\r\n        );\r\n        \r\n        // Calculate wellness index for yesterday\r\n        const wellnessIndex = calcWellnessIndex(\r\n          yesterdayMinuteData, \r\n          yesterdayHourData,\r\n          lastNight.sleep            \r\n        );\r\n        \r\n        setWellness(wellnessIndex);\r\n      }\r\n\r\n      setCurrentSteps(currentMinuteData.steps);\r\n      \r\n      minuteIndexRef.current = nextMinuteIndex;\r\n    }, simulationSpeed); \r\n\r\n    return () => clearInterval(interval);\r\n  }, [minuteSeries, hourSeries, daySeries, sleepSeries, dailySteps, simulationSpeed, isSimulationRunning]);\r\n\r\n  if (minuteSeries.length === 0) {\r\n    console.log(\"Loading data, minuteSeries.length:\", minuteSeries.length);\r\n    return <p>Loading data…</p>;\r\n  }\r\n\r\n  return (\r\n    <div>\r\n{/* Speed Control Panel */}\r\n    <div className=\"speed-control-panel\">\r\n      <div className=\"speed-controls\">\r\n        <div className=\"timestamp-display\">\r\n          {formatTimestamp(currentDataPoint?.timestamp)}\r\n        </div>\r\n        \r\n        <div className=\"speed-section\">\r\n          <label htmlFor=\"speed-slider\">Speed: {simulationSpeed}ms</label>\r\n          <input\r\n            id=\"speed-slider\"\r\n            type=\"range\"\r\n            min=\"1\"\r\n            max=\"100\"\r\n            step=\"1\"\r\n            value={simulationSpeed}\r\n            onChange={(e) => setSimulationSpeed(parseInt(e.target.value, 10))}\r\n            className=\"speed-slider\"\r\n          />\r\n          <button \r\n            onClick={() => setIsSimulationRunning(!isSimulationRunning)}\r\n            className=\"pause-button\"\r\n          >\r\n            {isSimulationRunning ? 'Pause' : 'Resume'}\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n      <div className=\"dashboard-grid\">\r\n      {currentDataPoint && (\r\n      <> \r\n        <div className=\"card\" id=\"multi\">\r\n          <MultiChart data={currentDataPoint} steps={currentSteps} titles={[\"Heart Rate\", \"Steps/Min\", \"Kcal/Min\"]} />\r\n      </div>\r\n        <div className=\"card\" id=\"stress\">\r\n          <div className=\"gauge\">\r\n            <GaugeChart data={{ data: currentDataPoint?.stress }} title=\"Stress Level\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"card\" id=\"steps\">\r\n          <div className=\"bar\">\r\n            <BarChart data={{ data: dailySteps }} title=\"Daily Steps\" />\r\n          </div>\r\n        </div>\r\n        <div className=\"card\" id=\"status\">\r\n          <div className=\"gauge\">\r\n            <GaugeChart data={{ data: currentDataPoint?.temperature }} title=\"Body Temperature\" />\r\n          </div>         \r\n        </div>\r\n      </>\r\n      )}\r\n      {avgStages && (\r\n        <div className=\"card\" id=\"avgstages\">\r\n          <div className=\"pie\">\r\n            <PieChart data={avgStages} title=\"Sleep Quality Average\"/>\r\n          </div> \r\n        </div>\r\n      )}\r\n      {currentDataPoint && (\r\n      <>\r\n        <div className=\"card\" id=\"laststages\">\r\n          <div className=\"span\">\r\n            <SpanChart data={currentStages}/>\r\n          </div> \r\n        </div>\r\n        <div className=\"card\" id=\"index\">\r\n          <div className=\"spider\">\r\n            <SpiderChart data={wellness}/>\r\n          </div> \r\n        </div>\r\n        <div className=\"card\" id=\"activity\">\r\n          <div className=\"mosaic\">\r\n            <MosaicChart data={activity}/>\r\n          </div> \r\n        </div>\r\n      </>\r\n      )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}